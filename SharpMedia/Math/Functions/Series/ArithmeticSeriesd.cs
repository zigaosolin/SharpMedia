// This file was generated by TemplateEngine from template source 'ArithmeticSeries'
// using template 'ArithmeticSeriesd. Do not modify this file directly, modify it from template source.

// This file constitutes a part of the SharpMedia project, (c) 2007 by the SharpMedia team
// and is licensed for your use under the conditions of the NDA or other legally binding contract
// that you or a legal entity you represent has signed with the SharpMedia team.
// In an event that you have received or obtained this file without such legally binding contract
// in place, you MUST destroy all files and other content to which this lincese applies and
// contact the SharpMedia team for further instructions at the internet mail address:
//
//    legal@sharpmedia.com
//
using System;
using System.Collections.Generic;
using System.Text;
using SharpMedia.Testing;
using SharpMedia.Math.Functions.Discrete;

namespace SharpMedia.Math.Functions.Series
{

    /// <summary>
    /// Arithmetic series, defined as:
    /// a, a+d, a+2d, ... a+n*d
    /// </summary>
    public class ArithmeticSeriesd : ISeriesd
    {
        #region Private Members
        private double a;
        private double d;
        #endregion

        #region Properties

        /// <summary>
        /// The difference between two adjected elements.
        /// </summary>
        public double Difference
        {
            get { return d; }
            set { d = value; }
        }

        /// <summary>
        /// An initial element of arithmetic series.
        /// </summary>
        public double Initial
        {
            get { return a; }
            set { a = value; }
        }

        #endregion

        #region Constructors

        /// <summary>
        /// Construction of arithmetic series.
        /// </summary>
        /// <param name="initial">The initial element.</param>
        /// <param name="dif">The difference between two elements in row.</param>
        public ArithmeticSeriesd(double initial, double dif)
        {
            a = initial;
            d = dif;
        }

        #endregion

        #region ISeriesd Members

        public DiscreteFunctiond Function
        {
            get
            {
                return delegate(uint x)
                {
                    return a + x * d;
                };
            }
        }

        public DiscreteFunctiond SumFunction
        {
            get
            {
                return delegate(uint x)
                {
                    return (double)0.5 * (double)(x + 1) * ((double)2.0 * a + (double)x * d);
                };
            }
        }

        public double[] Sample(uint begin, uint count)
        {
            double[] r = new double[count];
            for (int i = 0; i < count; i++)
            {
                r[i] = a + (begin + i) * d;
            }

            return r;
        }

        public double[] SampleSum(uint begin, uint count)
        {
            double[] r = new double[count];
            for (int i = 0; i < count; i++)
            {
                r[i] = (double)0.5 * (double)(begin + i + 1)
                       * ((double)2.0 * a + (begin + i) * d);
            }

            return r;
        }

        public double InfiniteSum
        {
            get { return double.PositiveInfinity * d; }
        }

        #endregion
    }


#if SHARPMEDIA_TESTSUITE
    [TestSuite]
    internal class Test_ArithmeticSeriesd
    {
        [CorrectnessTest]
        public void Properties()
        {
            ArithmeticSeriesd s = new ArithmeticSeriesd((double)1.0, (double)0.2);
            Assert.AreEqual((double)1.2, s.Function(1));
            Assert.AreEqual((double)2.2, s.SumFunction(1));
            Assert.AreEqual((double)1.0, s.Initial);
            Assert.AreEqual(double.PositiveInfinity, s.InfiniteSum);
            Assert.AreEqual((double)0.2, s.Difference);
        }
    }
#endif
}
